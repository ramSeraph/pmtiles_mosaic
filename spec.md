# PMTiles Mosaic JSON Specification

This document outlines the structure of the `.mosaic.json` file generated by the `pmtiles-mosaic` tools.

This file provides the necessary information for a client to understand how a single logical tileset has been partitioned into multiple physical PMTiles files (or "slices").

## Top-Level Object

The `mosaic.json` file consists of a single JSON object with the following top-level properties:

- `version` (Number): The version of the mosaic specification. Currently `1`.
- `metadata` (Object): The combined metadata object from the original source tileset, which is passed through to the client. This typically includes information like `name`, `description`, `attribution`, `format`, and `vector_layers`(optional).
- `header` (Object): A header object that describes the properties of the entire, combined tileset, as if it were a single PMTiles file. See the [Header Object](#header-object) section for details.
- `slices` (Object): An object containing an entry for each partition or slice of the tileset. The keys are the relative file paths to the individual PMTiles partition files, and the values are [Slice Objects](#slice-object).

> [!NOTE]
> The `metadata` and `header` objects are structured to match the [PMTiles Specification v3](https://github.com/protomaps/PMTiles/blob/main/spec/v3/spec.md) though filtered to only the values used in the clients.

### Header Object

The header object contains the following keys, which conform to the PMTiles header specification:

- `min_lon_e7`, `min_lat_e7`, `max_lon_e7`, `max_lat_e7` (Number): The bounding box of the entire tileset in E7 format (degrees * 10^7).
- `min_zoom`, `max_zoom` (Number): The minimum and maximum zoom levels available in the entire tileset.
- `center_lon_e7`, `center_lat_e7`, `center_zoom` (Number): The suggested center longitude, latitude, and zoom level for viewing the map.
- `tile_type` (Number): The tile format (e.g., 1 for MVT, 2 for PNG, 3 for JPEG).
- `tile_compression` (Number): The compression used for the tiles (e.g., 1 for Gzip, 0 for None).

### Slice Object

Each entry in the top-level `slices` object is a slice object, which contains a `header` for that specific partition.

- `header` (Object): A header object describing the contents of this specific slice. It contains a subset of the main header fields:
    - `min_lon_e7`, `min_lat_e7`, `max_lon_e7`, `max_lat_e7` (Number): The bounding box of this specific slice. These coordinates correspond to the bounds of the tiles at the `min_zoom` level of the slice, which provides a consistent bounding box for the entire slice.
    - `min_zoom`, `max_zoom` (Number): The minimum and maximum zoom levels contained within this slice.

## Example

```json
{
  "version": 1,
  "metadata": {
    "name": "My Awesome Map",
    "format": "pbf",
    "vector_layers": [
      {
        "id": "landuse",
        "minzoom": 0,
        "maxzoom": 14,
        "fields": {
          "class": "String"
        }
      }
    ]
  },
  "header": {
    "min_lon_e7": -1800000000,
    "min_lat_e7": -850511280,
    "max_lon_e7": 1800000000,
    "max_lat_e7": 850511280,
    "min_zoom": 0,
    "max_zoom": 14,
    "center_zoom": 8,
    "center_lon_e7": 0,
    "center_lat_e7": 0,
    "tile_type": 1,
    "tile_compression": 1
  },
  "slices": {
    "my-map-part0000.pmtiles": {
      "header": {
        "min_lon_e7": -1800000000,
        "min_lat_e7": -850511280,
        "max_lon_e7": 1800000000,
        "max_lat_e7": 850511280,
        "min_zoom": 0,
        "max_zoom": 8
      }
    },
    "my-map-part0001.pmtiles": {
      "header": {
        "min_lon_e7": -1800000000,
        "min_lat_e7": -850511280,
        "max_lon_e7": 0,
        "max_lat_e7": 850511280,
        "min_zoom": 9,
        "max_zoom": 14
      }
    },
    "my-map-part0002.pmtiles": {
      "header": {
        "min_lon_e7": 0,
        "min_lat_e7": -850511280,
        "max_lon_e7": 1800000000,
        "max_lat_e7": 850511280,
        "min_zoom": 9,
        "max_zoom": 14
      }
    }
  }
}
```
